<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OBS-Die-Firma – Sortiment</title>
  <meta name="theme-color" content="#003b1f">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">

  <style>
    body{
      margin:0; padding:2rem;
      font-family:"Inter",sans-serif;
      background:#fff;
      color:#111;
    }

    main{
      width:min(1000px,100%);
      margin:auto;
    }

    /* ===== TICKER ===== */
    .ticker{overflow:hidden;margin-bottom:1.4rem}
    .ticker-bar{
      background:linear-gradient(90deg,#2fb457,#0c8a43);
      padding:.8rem 0;
      font-weight:900;
      color:#fff;
      border-radius:12px;
    }
    .ticker-track{
      white-space:nowrap;
      display:inline-block;
      animation:scroll 120s linear infinite;
    }
    @keyframes scroll{
      0%{transform:translateX(100%)}
      100%{transform:translateX(-100%)}
    }
    .ticker-item{margin:0 1.6rem}

    /* ===== HERO ===== */
    .hero{text-align:center;margin-bottom:1.6rem}
    .brand{
      font-size:3.4rem;
      font-weight:900;
      background:linear-gradient(180deg,#0b5d2a,#0c8a43,#34c759,#c8ffd8);
      -webkit-background-clip:text;
      color:transparent;
    }
    .tagline{
      margin-top:.4rem;
      text-transform:uppercase;
      font-weight:800;
      color:#0b5d2a;
    }

    /* ===== PRODUKTE ===== */
    .slot{
      border:1px solid #e6e9e7;
      border-radius:14px;
      padding:1.2rem;
      margin-bottom:1rem;
      background:#fff;
    }
    .slot-body{
      display:flex; gap:12px;
    }
    .idx{
      width:64px;height:64px;
      background:#0c8a43;
      color:#fff;
      border-radius:12px;
      font-weight:900;
      display:flex;align-items:center;justify-content:center;
      font-size:1.3rem;
    }

    img{max-width:100%;border-radius:12px;margin-top:1rem}

    .product3-images{
      position:relative;
      max-width:420px;
      margin:1rem auto 0;
    }
    .product3-main{
      width:100%;
      border-radius:12px;
    }
    .product3-overlay{
      position:absolute;
      width:60%;
      bottom:-25%;
      right:-25%;
      border-radius:12px;
      box-shadow:0 5px 15px rgba(0,0,0,.3);
    }
    .product3-tag5{
      position:absolute;
      width:60%;
      bottom:-25%;
      left:-20%;
      border-radius:12px;
      box-shadow:0 5px 15px rgba(0,0,0,.3);
    }
    .product3-tag6{
      position:absolute;
      width:55%;
      left:50%;
      transform:translateX(-50%);
      bottom:-36%;
      border-radius:12px;
      box-shadow:0 5px 15px rgba(0,0,0,.3);
    }

    /* ===== SPIEL ===== */
    .card{
      border:1px solid #e6e9e7;
      padding:1.2rem;
      border-radius:14px;
      margin-top:1.2rem;
    }
    .game-grid{
      display:grid;
      grid-template-columns:repeat(3,90px);
      gap:10px;
      justify-content:center;
      margin-top:1rem;
    }
    .tile{
      width:90px;height:90px;
      border:1px solid #ddd;
      border-radius:10px;
      position:relative;
      cursor:pointer;
      background:#eee;
    }
    .tile .cover{
      position:absolute; inset:0;
      background:linear-gradient(180deg,#fafafa,#e5e5e5);
      transition:opacity .25s;
    }
    .pill{
      background:#f3f3f3;
      border:1px solid #ddd;
      padding:6px 10px;
      border-radius:999px;
      font-weight:700;
    }
    .win{color:#0b5d2a;font-weight:900}
    .lose{color:#b00020;font-weight:900}

    /* ===== FORMULAR ===== */
    input,select,textarea{
      width:100%;padding:10px;
      border:1px solid #dcdcdc;
      border-radius:10px;
      font-size:1rem;
    }
    button{
      padding:12px 16px;
      border-radius:12px;
      border:0;
      background:#0c8a43;
      color:#fff;
      font-weight:900;
      cursor:pointer;
    }
    .row{
      display:grid;
      grid-template-columns:1fr 140px 160px;
      gap:10px;
      align-items:end;
      margin-top:1rem;
    }
    .grid{display:grid;gap:12px}
    .totals{
      margin-top:.8rem;
      display:flex;justify-content:space-between;
      font-weight:900;
    }
    .error{color:#b00020;margin-top:.4rem;font-weight:700}
    .success{color:#0b5d2a;margin-top:.4rem;font-weight:700}

  </style>
</head>

<body>

<!-- ===== TICKER ===== -->
<div class="ticker">
  <div class="ticker-bar">
    <div id="tickerTrack" class="ticker-track">Lade Neuigkeiten …</div>
  </div>
</div>

<main>

<header class="hero">
  <h1 class="brand">OBS-Die-Firma</h1>
  <div class="tagline">Sortiment</div>
</header>

<!-- =====================================================
     PRODUKT 1
===================================================== -->
<article class="slot">
  <div class="slot-body">
    <div class="idx">#1</div>
    <div>
      <h2>Personalisierter Glas-Tag</h2>
      <p>Die eigene Produktentwicklung der OBS – ideal für Feiern, Geburtstage und Events.</p>
      <ul style="margin-top:.6rem;font-weight:700;color:#d40000;list-style:none;padding:0">
        <li>Einzel: 1,50 €</li>
        <li>5er-Pack: 4,95 €</li>
        <li>10er-Pack: 9,95 €</li>
      </ul>
    </div>
  </div>
  <img src="Tag.jpeg">
</article>

<!-- =====================================================
     PRODUKT 2
===================================================== -->
<article class="slot">
  <div class="slot-body">
    <div class="idx">#2</div>
    <div>
      <h2>Deluxe Kakao „Chocolate Bomb“</h2>
      <p>Mit heißer Milch übergießen – cremiger Kakao sofort.</p>
      <p style="margin-top:.5rem;font-weight:700;color:#d40000">Preis: 5,00 €</p>
    </div>
  </div>
  <img src="Tag2.jpeg">
</article>

<!-- =====================================================
     PRODUKT 3
===================================================== -->
<article class="slot">
  <div class="slot-body">
    <div class="idx">#3</div>
    <div>
      <h2>Instant Kakao „Schneemann“</h2>
      <p>Kakao + Marshmallows – perfekte Geschenkidee.</p>
      <p style="margin-top:.5rem;font-weight:700;color:#d40000">Preis: 5,00 €</p>
    </div>
  </div>

  <div class="product3-images">
    <img src="Schneemann2.jpeg" class="product3-main">
    <img src="Schneemann1.jpeg" class="product3-overlay">
    <img src="TAG5.jpeg" class="product3-tag5">
    <img src="TAG6.jpeg" class="product3-tag6">
  </div>
</article>


<!-- =====================================================
     GEWINNSPIEL
===================================================== -->
<section class="card">
  <h2>Gewinnspiel: Gewinne einen Glas-Tag</h2>
  <p>Decke in 5 Versuchen drei gleiche Farben auf.</p>

  <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
    <button type="button" id="startGameBtn">Spiel starten</button>
    <button type="button" id="newGameBtn" class="hidden">Neues Spiel</button>
    <span class="pill">Versuche: <span id="triesLeft">–</span></span>
    <span class="pill">Treffer: <span id="matchCount">0</span></span>
    <span class="pill hidden" id="cooldownPill">Warte <span id="cooldownSec">0</span>s</span>
  </div>

  <div id="gameGrid" class="game-grid"></div>
  <div id="gameMsg" style="margin-top:8px;"></div>
</section>


<!-- =====================================================
     BESTELLFORMULAR
===================================================== -->
<form id="orderForm" class="card" novalidate>

  <input type="text" id="hp_field" style="position:absolute;left:-9999px">

  <h2>Kundendaten</h2>
  <div class="grid" style="grid-template-columns:1fr 1fr">
    <div><label>Name*</label><input id="name" required></div>
    <div><label>Telefon*</label><input id="phone" required></div>
    <div style="grid-column:1/-1"><label>E-Mail*</label><input id="email" type="email" required></div>
    <div style="grid-column:1/-1"><label>Gewinncode</label><input id="coupon"></div>
  </div>

  <h2 style="margin-top:1.4rem">Produkte</h2>

  <!-- Produkt 1 -->
  <div class="row">
    <div>
      <label>Produkt 1</label>
      <select id="p1Pack">
        <option value="single">Einzel</option>
        <option value="pack5">5er-Pack</option>
        <option value="pack10">10er-Pack</option>
      </select>
      <div class="mute" id="p1PiecesHint">Aktuell: 0 Stück</div>
    </div>
    <div><label>Menge</label><input id="p1Qty" type="number" min="0" value="0"></div>
    <div><label>Summe</label><input id="p1Subtotal" readonly></div>
  </div>

  <div id="p1NamesBlock" class="grid hidden" style="margin-top:.6rem">
    <label>Namen (pro Zeile ein Name)</label>
    <textarea id="p1Names" rows="4"></textarea>
    <div id="p1NamesError" class="error hidden">Anzahl stimmt nicht.</div>
  </div>

  <!-- Produkt 2 -->
  <div class="row">
    <div><label>Produkt 2</label><div>5,00 €</div></div>
    <div><label>Menge</label><input id="p2Qty" type="number" min="0" value="0"></div>
    <div><label>Summe</label><input id="p2Subtotal" readonly></div>
  </div>

  <!-- Produkt 3 -->
  <div class="row">
    <div><label>Produkt 3</label><div>5,00 €</div></div>
    <div><label>Menge</label><input id="p3Qty" type="number" min="0" value="0"></div>
    <div><label>Summe</label><input id="p3Subtotal" readonly></div>
  </div>

  <div class="totals">
    <span>Gesamt</span>
    <span id="grandTotal">0,00 €</span>
  </div>

  <button type="submit" style="margin-top:1rem">Absenden</button>

  <div id="formError" class="error hidden"></div>
  <div id="formOk" class="success hidden">Gesendet – wir melden uns!</div>

</form>

<footer style="margin-top:2rem;text-align:center">
  <a href="/impressum.html">Impressum</a> · 
  <a href="/datenschutz.html">Datenschutz</a>
</footer>

</main>

<!-- =====================================================
     SCRIPTS
===================================================== -->
<script>
(function(){
  const t=document.getElementById('tickerTrack');
  t.innerHTML = `
    <span class="ticker-item">Glas-Tags – eigene Produktentwicklung der OBS.</span>
    <span class="ticker-item">Deluxe Kakao „Chocolate Bomb“.</span>
    <span class="ticker-item">Instant Kakao „Schneemann“ – limitierte Aktion.</span>
    <span class="ticker-item">Alle Erlöse stärken das Projekt!</span>
  `;
})();
</script>

<script>
(function initGame(){

  const startBtn=document.getElementById('startGameBtn');
  const newBtn=document.getElementById('newGameBtn');
  const grid=document.getElementById('gameGrid');
  const msg=document.getElementById('gameMsg');
  const triesEl=document.getElementById('triesLeft');
  const matchEl=document.getElementById('matchCount');
  const cooldown=document.getElementById('cooldownPill');
  const coolSec=document.getElementById('cooldownSec');
  const coupon=document.getElementById('coupon');

  const COLORS=['#0c8a43','#ffb300','#1565c0'];
  let tiles=[],tries=5,matches=0,running=false,fail=0,locked=false,timer=null;

  function build(){
    grid.innerHTML=''; tiles=[];
    const pool=[];
    COLORS.forEach(c=>{for(let i=0;i<3;i++) pool.push(c)});
    pool.sort(()=>Math.random()-0.5);

    pool.forEach(c=>{
      let t=document.createElement('div');
      t.className='tile';
      t.dataset.color=c;
      let cov=document.createElement('div');
      cov.className='cover'; t.appendChild(cov);
      t.onclick=()=>{if(!locked) reveal(t)};
      grid.appendChild(t); tiles.push(t);
    });
  }

  function reset(){
    tries=5; matches=0; fail=0; locked=false;
    triesEl.textContent=tries;
    matchEl.textContent=matches;
    msg.textContent='';
    msg.className='';
    cooldown.classList.add('hidden');
    if(timer) clearInterval(timer);
    build(); running=true;
  }

  function code(){
    return 'GT-' + Math.floor(10000+Math.random()*90000);
  }

  function reveal(t){
    if(!running) return;
    let cov=t.querySelector('.cover');
    if(!cov || cov.style.opacity==='0') return;

    cov.style.opacity='0';
    t.style.background=t.dataset.color;

    let count = tiles.filter(x=>{
      let c=x.querySelector('.cover');
      return x.dataset.color===t.dataset.color && c.style.opacity==='0';
    }).length;

    if(count===3){
      running=false;
      let c=code();
      coupon.value=c;
      msg.innerHTML=`GEWONNEN! Dein Code: <strong>${c}</strong>`;
      msg.className='win';
      return;
    }

    tries--; triesEl.textContent=tries;

    if(tries<=0){
      running=false;
      msg.textContent='Leider kein Treffer.';
      msg.className='lose';
      return;
    }

    fail++;
    locked=true;
    let sec=fail*2;
    cooldown.classList.remove('hidden');
    coolSec.textContent=sec;

    if(timer) clearInterval(timer);
    timer=setInterval(()=>{
      sec--; coolSec.textContent=sec;
      if(sec<=0){
        clearInterval(timer);
        locked=false;
        cooldown.classList.add('hidden');
      }
    },1000);
  }

  startBtn.onclick=()=>{
    startBtn.classList.add('hidden');
    newBtn.classList.remove('hidden');
    reset();
  };
  newBtn.onclick=()=>reset();

})();
</script>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
emailjs.init("xAOygDJhZcJrXGuSb");
</script>

<script>
(function initForm(){

  const form=document.getElementById('orderForm');
  const err=document.getElementById('formError');
  const ok=document.getElementById('formOk');

  const p1Pack=document.getElementById('p1Pack');
  const p1Qty=document.getElementById('p1Qty');
  const p1Subtotal=document.getElementById('p1Subtotal');
  const p1NamesBlock=document.getElementById('p1NamesBlock');
  const p1Names=document.getElementById('p1Names');
  const p1NamesError=document.getElementById('p1NamesError');
  const p1PiecesHint=document.getElementById('p1PiecesHint');

  const p2Qty=document.getElementById('p2Qty');
  const p2Subtotal=document.getElementById('p2Subtotal');

  const p3Qty=document.getElementById('p3Qty');
  const p3Subtotal=document.getElementById('p3Subtotal');

  const grand=document.getElementById('grandTotal');
  const cart=document.getElementById('cartPreview');

  const PACK_PR={single:1.50,pack5:4.95,pack10:9.95};
  const PACK_PC={single:1,pack5:5,pack10:10};
  const P2=5, P3=5;

  function clamp(n){n=parseInt(n)||0;return Math.max(0,Math.min(999,n))}
  function money(n){return n.toLocaleString('de-DE',{style:'currency',currency:'EUR'})}

  function update(){
    const pk=p1Pack.value;
    const q1=clamp(p1Qty.value), pc1=q1*PACK_PC[pk], t1=q1*PACK_PR[pk];
    const q2=clamp(p2Qty.value), t2=q2*P2;
    const q3=clamp(p3Qty.value), t3=q3*P3;

    p1Subtotal.value = q1>0 ? money(t1) : "";
    p1PiecesHint.textContent="Aktuell: "+pc1+" Stück";

    if(pc1>0) p1NamesBlock.classList.remove('hidden');
    else p1NamesBlock.classList.add('hidden');

    p2Subtotal.value = q2>0 ? money(t2) : "";
    p3Subtotal.value = q3>0 ? money(t3) : "";

    const sum=t1+t2+t3;
    grand.textContent=money(sum);

    const lines=[];
    if(pc1>0) lines.push(`Glas-Tag: ${pc1} Stück – ${money(t1)}`);
    if(q2>0) lines.push(`Chocolate Bomb: ${q2}× – ${money(t2)}`);
    if(q3>0) lines.push(`Schneemann: ${q3}× – ${money(t3)}`);
    cart.innerHTML = lines.length ? lines.join("<br>") : "Noch keine Artikel.";

    return {pc1,t1,q1,q2,t2,q3,t3,sum};
  }

  p1Pack.onchange=update;
  p1Qty.oninput=update;
  p2Qty.oninput=update;
  p3Qty.oninput=update;
  update();

  function countLines(s){
    return s.split(/\n/).map(v=>v.trim()).filter(Boolean).length;
  }

  form.onsubmit=function(e){
    e.preventDefault();
    err.classList.add('hidden'); ok.classList.add('hidden');

    if(document.getElementById('hp_field').value.trim()!==""){return;}

    const name=document.getElementById('name').value.trim();
    const phone=document.getElementById('phone').value.trim();
    const email=document.getElementById('email').value.trim();
    const coupon=document.getElementById('coupon').value.trim();

    if(!name||!phone||!email){
      err.textContent="Bitte Name, Telefon und E-Mail eingeben.";
      err.classList.remove("hidden");
      return;
    }

    const s=update();

    if(s.pc1===0 && s.q2===0 && s.q3===0){
      err.textContent="Bitte mindestens ein Produkt auswählen.";
      err.classList.remove("hidden");
      return;
    }

    if(s.pc1>0){
      const given=countLines(p1Names.value);
      if(given!==s.pc1){
        p1NamesError.classList.remove("hidden");
        err.textContent="Die Anzahl der Namen passt nicht.";
        err.classList.remove("hidden");
        return;
      }
    }

    const lines=[];
    if(s.pc1>0) lines.push(`Glas-Tag: ${s.pc1} Stück – ${money(s.t1)}`);
    if(s.q2>0) lines.push(`Chocolate Bomb: ${s.q2}× – ${money(s.t2)}`);
    if(s.q3>0) lines.push(`Schneemann: ${s.q3}× – ${money(s.t3)}`);

    emailjs.send("service_l642tri","template_ggtexbv",{
      name, phone, email, coupon,
      products:lines.join("<br>"),
      total:money(s.sum),
      names_list:p1Names.value
    })
    .then(()=>{
      ok.classList.remove("hidden");
      form.reset();
      p1NamesBlock.classList.add("hidden");
      update();
    })
    .catch(()=>{
      err.textContent="Fehler beim Senden.";
      err.classList.remove("hidden");
    });
  };

})();
</script>

</body>
</html>
