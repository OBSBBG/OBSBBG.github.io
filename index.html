<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OBS-Die-Firma – Sortiment</title>
  <meta name="description" content="OBS-Die-Firma: Glas-Tags & Deluxe Kakao. Jetzt bestellen und in der Schülerfirma abholen.">
  <meta name="theme-color" content="#003b1f">

  <!-- Moderne Schriften -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --accent-green:#0c8a43; 
      --green:#34c759;
      --deep-green:#0b5d2a; 
      --price:#d40000;
      --ink:#161817; --border:#e6e9e7;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Inter",sans-serif;
      padding:2rem;
      background:#fff;
      color:var(--ink);
    }

    main{width:min(1000px,100%);margin:auto}

    /* ===== TICKER ===== */
    .ticker{width:100%;overflow:hidden;margin-bottom:1.5rem}
    .ticker-bar{
      background:linear-gradient(90deg,#2fb457,#0c8a43);
      padding:.8rem 0;color:#fff;font-weight:800;
      border-radius:12px;
    }
    .ticker-track{
      white-space:nowrap;
      display:inline-block;
      animation:scroll 120s linear infinite;
    }
    .ticker-item{margin:0 1.6rem}
    @keyframes scroll{
      0%{transform:translateX(100%)} 
      100%{transform:translateX(-100%)}
    }

    /* ===== HERO ===== */
    .hero{text-align:center;margin-bottom:1.5rem}
    .brand{
      font-size:3.8rem;
      font-weight:900;
      background:linear-gradient(180deg,#0b5d2a,#0c8a43,#34c759,#c8ffd8);
      -webkit-background-clip:text;
      color:transparent;
    }
    .tagline{
      margin-top:.4rem;
      text-transform:uppercase;
      font-weight:800;
      color:#0b5d2a;
    }

    /* ===== PRODUKTE ===== */
    .slot{
      border:1px solid var(--border);
      border-radius:16px;
      padding:1.2rem;
      margin-bottom:1rem;
      background:#fff;
    }
    .slot-body{
      display:flex;
      gap:12px;
    }
    .idx{
      width:64px;height:64px;
      background:#0c8a43;
      color:#fff;
      font-weight:900;
      border-radius:12px;
      display:flex;justify-content:center;align-items:center;
      font-size:1.3rem;
    }

    .product3-images{
      position:relative;
      max-width:420px;
      margin:1rem auto 0;
    }
    .product3-main{width:100%;border-radius:12px}
    .product3-overlay{
      position:absolute;
      width:60%;
      right:-25%;
      bottom:-25%;
      border-radius:12px;
      box-shadow:0 8px 22px rgba(0,0,0,.35);
    }

    /* Zusatzbilder TAG5 / TAG6 */
    .product3-tag5{
      position:absolute;
      width:60%;
      left:-20%;
      bottom:-25%;
      border-radius:12px;
      box-shadow:0 8px 22px rgba(0,0,0,.35);
    }
    .product3-tag6{
      position:absolute;
      width:55%;
      left:50%;
      transform:translateX(-50%);
      bottom:-38%;
      border-radius:12px;
      box-shadow:0 8px 22px rgba(0,0,0,.35);
    }

    /* ===== SPIEL ===== */
    .game-grid{
      display:grid;
      grid-template-columns:repeat(3,90px);
      gap:10px;
      justify-content:center;
      margin-top:1rem;
    }
    .tile{
      width:90px;height:90px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#eee;
      cursor:pointer;
      overflow:hidden;
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .cover{
      position:absolute;
      inset:0;
      background:linear-gradient(180deg,#fdfdfd,#e5e5e5);
      transition:opacity .25s;
    }
    .pill{
      background:#f4f4f4;
      border:1px solid var(--border);
      padding:6px 10px;
      border-radius:999px;
      font-weight:700;
    }
    .win{color:#0b5d2a;font-weight:800}
    .lose{color:#b00020;font-weight:800}

    /* ===== FORMULAR ===== */
    input,select,textarea{
      width:100%;
      padding:10px;
      border:1px solid var(--border);
      border-radius:10px;
      font-size:1rem;
    }
    button{
      padding:12px 16px;
      background:#0c8a43;
      color:#fff;
      border:0;
      border-radius:12px;
      font-weight:900;
      cursor:pointer;
    }
    .card{
      border:1px solid var(--border);
      padding:1rem;
      border-radius:14px;
      margin-top:1.2rem;
      background:#fff;
    }
    .grid{
      display:grid;
      gap:12px;
    }
    .row{
      display:grid;
      grid-template-columns:1fr 140px 160px;
      gap:10px;
      align-items:end;
    }
    .totals{
      display:flex;
      justify-content:space-between;
      margin-top:1rem;
      font-weight:900;
    }
    .error{color:#b00020;margin-top:.5rem}
    .success{color:#0b5d2a;margin-top:.5rem}

  </style>
</head>

<body>

  <!-- ===== TICKER ===== -->
  <div class="ticker">
    <div class="ticker-bar">
      <div id="tickerTrack" class="ticker-track">Lade Neuigkeiten …</div>
    </div>
  </div>

  <main>
    <header class="hero">
      <h1 class="brand">OBS-Die-Firma</h1>
      <div class="tagline">Sortiment</div>
    </header>
<script>
/* ======================================================
   TICKER
====================================================== */
(function initTicker(){
  const t=document.getElementById('tickerTrack');
  t.innerHTML = `
    <span class="ticker-item">Glas-Tags – eigene Produktentwicklung der OBS.</span>
    <span class="ticker-item">Deluxe Kakao „Chocolate Bomb“ – nur für kurze Zeit.</span>
    <span class="ticker-item">Instant Kakao „Schneemann“ – limitierte Aktion.</span>
    <span class="ticker-item">Alle Erlöse stärken das Projekt – Danke!</span>
  `;
})();
</script>


<script>
/* ======================================================
   GEWINNSPIEL — MIT GEWINNCODE + SOFORTGEWINN + COOLDOWN
====================================================== */

(function initGame(){

  const startBtn = document.getElementById('startGameBtn');
  const newBtn   = document.getElementById('newGameBtn');
  const grid     = document.getElementById('gameGrid');
  const msg      = document.getElementById('gameMsg');
  const triesEl  = document.getElementById('triesLeft');
  const matchEl  = document.getElementById('matchCount');
  const cooldown = document.getElementById('cooldownPill');
  const coolSec  = document.getElementById('cooldownSec');
  const couponField = document.getElementById('coupon');

  const COLORS = ['#0c8a43','#ffb300','#1565c0'];

  let tiles=[],
      tries=5,
      matches=0,
      running=false,
      failCount=0,
      clickLocked=false,
      timer=null;

  function buildTiles(){
    grid.innerHTML='';
    tiles=[];

    const pool=[];
    COLORS.forEach(col => { for(let i=0;i<3;i++) pool.push(col); });
    pool.sort(()=>Math.random()-0.5);

    pool.forEach(color=>{
      const tile=document.createElement('div');
      tile.className='tile';
      tile.dataset.color=color;

      const cover=document.createElement('div');
      cover.className='cover';
      tile.appendChild(cover);

      tile.onclick = ()=>{ if(!clickLocked) reveal(tile); };
      grid.appendChild(tile);
      tiles.push(tile);
    });
  }

  function resetGame(){
    tries = 5;
    matches = 0;
    failCount = 0;
    clickLocked = false;

    triesEl.textContent = tries;
    matchEl.textContent = matches;
    msg.textContent = '';
    msg.className = '';

    cooldown.classList.add('hidden');
    if(timer){ clearInterval(timer); timer=null; }

    buildTiles();
    running = true;
  }

  function generateCode(){
    const n = Math.floor(10000 + Math.random()*90000);
    return "GT-" + n;
  }

  function reveal(tile){
    if(!running) return;

    const cover = tile.querySelector('.cover');
    if(!cover || cover.style.opacity==='0') return;

    cover.style.opacity='0';
    tile.style.background = tile.dataset.color;

    const same = tiles.filter(t=>{
      const cv = t.querySelector('.cover');
      return t.dataset.color===tile.dataset.color && cv.style.opacity==='0';
    }).length;

    if(same === 3){
      matches++;
      matchEl.textContent = matches;

      // Sofortgewinn
      running = false;

      const code = generateCode();
      couponField.value = code;

      msg.innerHTML = `GEWONNEN! Dein Code: <strong>${code}</strong>`;
      msg.className = 'win';

      return;
    }

    tries--;
    triesEl.textContent = tries;

    if(tries <= 0){
      running=false;
      msg.textContent="Leider kein Treffer.";
      msg.className="lose";
      return;
    }

    /* ===== FEHLVERSUCH → COOLDOWN ===== */
    failCount++;
    const lockTime = failCount * 2; // Sekunden

    clickLocked = true;
    cooldown.classList.remove('hidden');
    coolSec.textContent = lockTime;

    let sec = lockTime;
    if(timer) clearInterval(timer);

    timer = setInterval(()=>{
      sec--;
      coolSec.textContent = sec;
      if(sec <= 0){
        clearInterval(timer);
        clickLocked = false;
        cooldown.classList.add('hidden');
      }
    },1000);
  }

  startBtn.onclick = ()=>{
    startBtn.classList.add('hidden');
    newBtn.classList.remove('hidden');
    resetGame();
  };

  newBtn.onclick = ()=> resetGame();

})();
</script>


<script>
/* ======================================================
   SHOP / WARENKORB / EMAILJS
====================================================== */

(function initShop(){

  const p1Pack=document.getElementById('p1Pack');
  const p1Qty=document.getElementById('p1Qty');
  const p1Subtotal=document.getElementById('p1Subtotal');
  const p1PiecesHint=document.getElementById('p1PiecesHint');
  const p1NamesBlock=document.getElementById('p1NamesBlock');
  const p1Names=document.getElementById('p1Names');
  const p1NamesError=document.getElementById('p1NamesError');

  const p2Qty=document.getElementById('p2Qty');
  const p2Subtotal=document.getElementById('p2Subtotal');

  const p3Qty=document.getElementById('p3Qty');
  const p3Subtotal=document.getElementById('p3Subtotal');

  const grandTotal=document.getElementById('grandTotal');
  const cartPreview=document.getElementById('cartPreview');

  const PACK_PRICES={ single:1.50, pack5:4.95, pack10:9.95 };
  const PACK_PIECES={ single:1,    pack5:5,    pack10:10   };
  const P2_PRICE=5.00;
  const P3_PRICE=5.00;

  const clamp = n => Math.max(0, Math.min(999, parseInt(n)||0));
  const money = n => n.toLocaleString("de-DE",{style:"currency",currency:"EUR"});

  function updateP1(){
    const pack=p1Pack.value;
    const qty=clamp(p1Qty.value);

    p1Qty.value=qty;

    const totalPieces=qty*PACK_PIECES[pack];
    const totalPrice=qty*PACK_PRICES[pack];

    p1Subtotal.value = qty>0 ? money(totalPrice) : "";
    p1PiecesHint.textContent = "Aktuell: "+totalPieces+" Stück";

    if(totalPieces>0) p1NamesBlock.classList.remove("hidden");
    else p1NamesBlock.classList.add("hidden");

    return {totalPieces,totalPrice,qty};
  }

  function updateP2(){
    const qty=clamp(p2Qty.value);
    p2Qty.value=qty;
    const total=qty*P2_PRICE;
    p2Subtotal.value = qty>0 ? money(total) : "";
    return {qty,total};
  }

  function updateP3(){
    const qty=clamp(p3Qty.value);
    p3Qty.value=qty;
    const total=qty*P3_PRICE;
    p3Subtotal.value = qty>0 ? money(total) : "";
    return {qty,total};
  }

  function refresh(){
    const p1=updateP1();
    const p2=updateP2();
    const p3=updateP3();

    const sum = p1.totalPrice + p2.total + p3.total;
    grandTotal.textContent = money(sum);

    const lines=[];
    if(p1.totalPieces>0) lines.push(`Glas-Tag: ${p1.totalPieces} Stück – ${money(p1.totalPrice)}`);
    if(p2.qty>0) lines.push(`Chocolate Bomb: ${p2.qty}× – ${money(p2.total)}`);
    if(p3.qty>0) lines.push(`Schneemann: ${p3.qty}× – ${money(p3.total)}`);

    cartPreview.innerHTML = lines.length ? lines.join("<br>") : "Noch keine Artikel.";
  }

  p1Pack.onchange = refresh;
  p1Qty.oninput = refresh;
  p2Qty.oninput = refresh;
  p3Qty.oninput = refresh;

  refresh();

})();
</script>
<!-- =====================================================
     EMAILJS
===================================================== -->
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<script>
const EMAILJS_PUBLIC_KEY   = 'xAOygDJhZcJrXGuSb';
const EMAILJS_SERVICE_ID   = 'service_l642tri';
const EMAILJS_TEMPLATE_ID  = 'template_ggtexbv';

(function(){
  emailjs.init(EMAILJS_PUBLIC_KEY);
})();
</script>


<script>
/* ======================================================
   FORMULAR SENDEN & VALIDIEREN
====================================================== */

(function initForm(){

  const form      = document.getElementById('orderForm');
  const formErr   = document.getElementById('formError');
  const formOk    = document.getElementById('formOk');

  const p1NamesBlock = document.getElementById('p1NamesBlock');
  const p1Names      = document.getElementById('p1Names');
  const p1NamesError = document.getElementById('p1NamesError');

  const p1Qty        = document.getElementById('p1Qty');
  const p1Pack       = document.getElementById('p1Pack');

  const p2Qty        = document.getElementById('p2Qty');
  const p3Qty        = document.getElementById('p3Qty');

  const p1PiecesHint = document.getElementById('p1PiecesHint');

  const grandTotal   = document.getElementById('grandTotal');
  const cartPreview  = document.getElementById('cartPreview');


  const PACK_PRICES={ single:1.50, pack5:4.95, pack10:9.95 };
  const PACK_PIECES={ single:1,    pack5:5,    pack10:10   };
  const P2_PRICE=5.00;
  const P3_PRICE=5.00;

  function clamp(n){ n=parseInt(n)||0; return Math.max(0,Math.min(999,n)); }
  function money(n){ return n.toLocaleString("de-DE",{style:"currency",currency:"EUR"}); }

  function updateAll(){
    const p1pack = p1Pack.value;
    const p1q   = clamp(p1Qty.value);
    const p1pcs = p1q * PACK_PIECES[p1pack];
    const p1tot = p1q * PACK_PRICES[p1pack];

    const p2q   = clamp(p2Qty.value);
    const p2tot = p2q * P2_PRICE;

    const p3q   = clamp(p3Qty.value);
    const p3tot = p3q * P3_PRICE;

    p1PiecesHint.textContent = "Aktuell: "+p1pcs+" Stück";

    if(p1pcs>0) p1NamesBlock.classList.remove("hidden");
    else        p1NamesBlock.classList.add("hidden");

    const sum = p1tot+p2tot+p3tot;
    grandTotal.textContent = money(sum);

    const lines=[];
    if(p1pcs>0) lines.push(`Glas-Tag: ${p1pcs} Stück – ${money(p1tot)}`);
    if(p2q>0)   lines.push(`Chocolate Bomb: ${p2q}× – ${money(p2tot)}`);
    if(p3q>0)   lines.push(`Schneemann: ${p3q}× – ${money(p3tot)}`);

    cartPreview.innerHTML = lines.length ? lines.join("<br>") : "Noch keine Artikel.";

    return {p1pcs,p1tot,p1q,p2q,p2tot,p3q,p3tot,sum};
  }

  updateAll();

  p1Pack.onchange = updateAll;
  p1Qty.oninput   = updateAll;
  p2Qty.oninput   = updateAll;
  p3Qty.oninput   = updateAll;


  function countLines(s){
    return String(s).split(/\n/).map(v=>v.trim()).filter(Boolean).length;
  }

  form.onsubmit=function(e){
    e.preventDefault();

    formErr.classList.add("hidden");
    formOk.classList.add("hidden");

    if(document.getElementById('hp_field').value.trim()!==""){
      return; // Bot
    }

    const name   = document.getElementById('name').value.trim();
    const phone  = document.getElementById('phone').value.trim();
    const email  = document.getElementById('email').value.trim();
    const coupon = document.getElementById('coupon').value.trim();

    if(!name || !phone || !email){
      formErr.textContent="Bitte Name, Telefon und E-Mail ausfüllen.";
      formErr.classList.remove("hidden");
      return;
    }

    const state = updateAll();

    if(state.p1pcs===0 && state.p2q===0 && state.p3q===0){
      formErr.textContent="Bitte mindestens ein Produkt auswählen.";
      formErr.classList.remove("hidden");
      return;
    }

    if(state.p1pcs>0){
      const given = countLines(p1Names.value);
      if(given !== state.p1pcs){
        p1NamesError.classList.remove("hidden");
        formErr.textContent="Die Anzahl der Namen passt nicht.";
        formErr.classList.remove("hidden");
        return;
      }
    }

    const lines=[];
    if(state.p1pcs>0) lines.push(`Glas-Tag: ${state.p1pcs} Stück – ${money(state.p1tot)}`);
    if(state.p2q>0)   lines.push(`Chocolate Bomb: ${state.p2q}× – ${money(state.p2tot)}`);
    if(state.p3q>0)   lines.push(`Schneemann: ${state.p3q}× – ${money(state.p3tot)}`);

    const payload={
      name,
      phone,
      email,
      coupon,
      products:lines.join("<br>"),
      total:money(state.sum),
      names_list:p1Names.value
    };

    emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, payload)
      .then(()=>{
        formOk.classList.remove("hidden");
        form.reset();
        p1NamesBlock.classList.add("hidden");
        updateAll();
      })
      .catch(()=>{
        formErr.textContent="Formular konnte nicht gesendet werden.";
        formErr.classList.remove("hidden");
      });
  };

})();
</script>


<footer style="margin-top:2rem;text-align:center;font-size:.9rem;">
  <a href="/impressum.html">Impressum</a> · 
  <a href="/datenschutz.html">Datenschutz</a>
</footer>

</main>
</body>
</html>
