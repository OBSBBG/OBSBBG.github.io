<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>2 Sale 4 U</title>
  <meta name="description" content="Sonderaktion: Glas-Tag jetzt günstiger – Einzel 1,50 €, 5er 4,95 €, 10er 9,95 €. Deluxe Kakao 5 €. Jetzt bestellen.">
  <meta name="theme-color" content="#ffffff">
  <style>
    :root { color-scheme: light dark; --accent:#d40000; }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      display: grid;
      place-items: start center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      text-align: center;
      padding: 2rem;
      line-height: 1.35;
    }
    main { width: min(900px, 100%); }
    h1 { margin: 0; font-size: clamp(2.5rem, 10vw, 6rem); }
    h2 { margin: 0 0 .25rem; font-size: clamp(1.3rem, 4.5vw, 1.8rem); }
    .spacer { height: 2em; }
    p  { margin: 0; font-size: clamp(1.1rem, 3.6vw, 1.2rem); }

    img {
      display: block;
      max-width: 100%;
      height: auto;
      margin: 1.0rem auto 0;
      -webkit-user-drag: none;
      user-select: none;
      border-radius: 8px;
    }

    .slot {
      border: 2px dashed #999;
      border-radius: 12px;
      padding: 1.25rem;
      font-weight: 400;
      font-size: clamp(1.1rem, 3.8vw, 1.2rem);
      text-align: left;
      background: transparent;
    }
    .slot + .slot { margin-top: 1rem; }

    .slots {
      margin-top: 1.5rem;
      display: grid;
      gap: 1rem;
      grid-template-columns: 1fr;
    }
    @media (min-width: 720px) {
      .slots { grid-template-columns: repeat(2, 1fr); }
    }

    .price { font-weight: 700; }
    .desc { margin-top: .5rem; font-size: clamp(1rem, 3.2vw, 1.1rem); }

    .badge {
      display:inline-block; margin-left:.5rem;
      background: var(--accent); color:#fff; border-radius:.5rem;
      padding:.1rem .5rem; font-size:.9em; vertical-align: middle;
    }
    .price-old {
      color: var(--accent);
      text-decoration: line-through;
      text-decoration-thickness: .12em;
      text-decoration-color: var(--accent);
      font-weight: 700;
    }
    .price-new { color: var(--accent); font-weight: 800; }
    .price-list {
      margin:.5rem 0 0; padding-left:1.1rem;
      color: var(--accent); font-weight: 700;
    }
    .price-list li { margin:.15rem 0; }

    .note { margin-top:.6rem; font-size: .95em; font-weight: 600; }
    .asterisk-note{ margin-top:.4rem; font-size:.95em; color:var(--accent); font-weight:700; }

    a { color: inherit; }
    a:focus-visible, button:focus-visible, input:focus-visible, textarea:focus-visible, select:focus-visible {
      outline: 3px solid #666; outline-offset: 2px; border-radius: 6px;
    }

    footer {
      margin-top: 2.0rem;
      font-size: .95rem;
      opacity: .9;
    }
    footer small { display: block; margin-top: .25rem; opacity: .9; }
    footer nav a { text-decoration: underline; }

    /* --- Shop-Formular / Warenkorb --- */
    form.shop { text-align:left; margin-top:1.5rem }
    .card { border:1px solid #ddd; border-radius:12px; padding:16px; margin-top:16px }
    .grid { display:grid; gap:12px }
    .row { display:grid; grid-template-columns: 1fr 140px 160px; gap:8px; align-items:end }
    .row > div { display:grid; gap:6px }
    input, textarea, select, button { font: inherit }
    input, textarea, select { padding:10px; border:1px solid #ccc; border-radius:8px; width:100% }
    input[readonly] { background:#f8f8f8 }
    button { padding: 10px 14px; border-radius: 8px; border: 1px solid #ccc; background:#111; color:#fff; cursor:pointer }
    .muted { color:#666; font-size: .95rem }
    .totals { display:flex; justify-content:space-between; align-items:center; margin-top:12px; font-weight:800 }
    .error { color:#b00020; font-size:.95rem }
    .success { color:#0a7a30; font-size:.95rem }
    .hidden { display:none }
    hr.sep { border:0; border-top:1px solid #eee; margin:12px 0 }
    .footer-note { font-size:.85rem; color:#666; margin-top:.5rem }
  </style>
</head>
<body>
  <main>
    <h1>2 Sale 4 U</h1>
    <div class="spacer" aria-hidden="true"></div>

    <!-- #1: Sonderaktion -->
    <article class="slot">
      <h2>
        #1 Personalisierter Glas-Tag
        <span class="badge" aria-describedby="deal-note" aria-label="Sonderaktion">*</span>
      </h2>

      <p class="desc">Vorher: <span class="price-old">3 €</span></p>

      <ul class="price-list" aria-label="Aktionspreise">
        <li>Einzelpreis: <span class="price-new">1,50 €</span></li>
        <li>Fünferpack: <span class="price-new">4,95 €</span></li>
        <li>Zehnerpack: <span class="price-new">9,95 €</span></li>
      </ul>

      <p id="deal-note" class="asterisk-note">
        * Sonderaktion: gültig solange der Vorrat reicht.
      </p>

      <p class="desc" style="margin-top:.6rem">
        Der sinnvolle Helfer, wo sich Leute zur Geselligkeit treffen. Nachhaltig, weil wiederverwendbar.
        Und kein unnötiges Vollstellen mit Gläsern, von denen keiner mehr weiß, wem es gehörte.
        Spart den Geldbeutel bei der Spülmaschine und schont die Umwelt.
      </p>

      <p class="note">
        Wichtig: Bitte bei <strong>jeder Bestellung</strong> die <strong>Namen</strong> angeben, die auf die Glas-Tags sollen.
      </p>

      <img
        src="Tag.jpeg"
        alt="Personalisierter Glas-Tag mit Gravur"
        width="900" height="600"
        loading="eager" fetchpriority="high" decoding="async"
      >
    </article>

    <section class="slots" aria-label="Weitere Produkte folgen">
      <article class="slot">
        <h2>#2 Deluxe Kakao „All inclusive“ <span class="price">· 5 €</span></h2>
        <p class="desc">
          Das Wohlfühlglas mit der extra Portion Schokolade. Die Kugeln einfach mit heißer Milch übergießen –
          fertig ist der Winter-Schoko-Traum. Das Glas einfach in die Spülmaschine und beim nächsten Getränk
          nur den Strohhalm austauschen.
        </p>
        <img
          src="Tag2.jpeg"
          alt="Deluxe Kakao im Glas mit Schokoladen-Toppings"
          width="900" height="600"
          loading="lazy" decoding="async"
        >
      </article>

      <article class="slot">
        <h2>#3 – bald verfügbar</h2>
        <p class="desc">Trag dich per E-Mail ein, wir informieren dich, sobald #3 da ist.</p>
      </article>
    </section>

    <!-- ================= SHOP-FORMULAR / WARENKORB ================== -->
    <form id="orderForm" class="shop" novalidate>
      <!-- Honeypot gegen Bots -->
      <input type="text" id="hp_field" name="company" autocomplete="off" style="position:absolute;left:-9999px" tabindex="-1" aria-hidden="true">

      <!-- Kundendaten -->
      <div class="card">
        <h2>Kundendaten</h2>
        <div class="grid" style="grid-template-columns: 1fr 1fr; gap:12px">
          <div>
            <label for="name">Name*</label>
            <input id="name" name="name" required />
          </div>
          <div>
            <label for="phone">Telefon*</label>
            <input id="phone" name="phone" required />
          </div>
          <div style="grid-column: 1 / -1">
            <label for="email">E-Mail*</label>
            <input id="email" name="email" type="email" required />
          </div>
        </div>
      </div>

      <!-- Produkte -->
      <div class="card">
        <h2>Produkte</h2>

        <!-- Produkt 1: Glas-Tag mit Paketauswahl -->
        <div class="row">
          <div>
            <label for="p1Pack">Produkt 1: Glas-Tag</label>
            <select id="p1Pack" name="p1Pack">
              <option value="single">Einzel (1,50 € / Stück)</option>
              <option value="pack5">5er-Pack (4,95 € / Packung)</option>
              <option value="pack10">10er-Pack (9,95 € / Packung)</option>
            </select>
            <div class="muted" id="p1PiecesHint">Aktuell: 0 Stück</div>
          </div>
          <div>
            <label for="p1Qty">Anzahl Packungen</label>
            <input id="p1Qty" name="p1Qty" type="number" min="0" value="0" />
          </div>
          <div>
            <label>Zwischensumme</label>
            <input id="p1Subtotal" type="text" value="0,00 €" readonly />
          </div>
        </div>

        <div id="p1NamesBlock" class="grid hidden">
          <label for="p1Names">Namen für die Glas-Tags (ein Name pro Zeile) *</label>
          <textarea id="p1Names" name="p1Names" rows="5" placeholder="z. B. Anna&#10;Ben&#10;Cem"></textarea>
          <div class="muted">Die Anzahl der Zeilen muss der <strong>Gesamt-Stückzahl</strong> entsprechen.</div>
          <div id="p1NamesError" class="error hidden">Anzahl der Namen passt nicht zur Stückzahl.</div>
        </div>

        <hr class="sep" />

        <!-- Produkt 2: Deluxe Kakao -->
        <div class="row">
          <div>
            <label>Produkt 2: Deluxe Kakao</label>
            <div class="muted">Stückpreis: <span id="p2PriceLabel">5,00</span> €</div>
          </div>
          <div>
            <label for="p2Qty">Menge</label>
            <input id="p2Qty" name="p2Qty" type="number" min="0" value="0" />
          </div>
          <div>
            <label>Zwischensumme</label>
            <input id="p2Subtotal" type="text" value="0,00 €" readonly />
          </div>
        </div>

        <div class="totals">
          <div>Gesamt</div>
          <div id="grandTotal">0,00 €</div>
        </div>
      </div>

      <!-- Warenkorb-Preview -->
      <div class="card">
        <h2>Warenkorb</h2>
        <div id="cartPreview" class="muted">Noch keine Artikel.</div>
      </div>

      <!-- Absenden -->
      <div class="grid" style="grid-template-columns: 1fr auto; gap:12px">
        <div class="muted">Mit Klick auf „Bestellung abschicken“ bestätigst du die Angaben.</div>
        <button type="submit">Bestellung abschicken</button>
      </div>
      <div id="formError" class="error hidden" role="alert"></div>
      <div id="formOk" class="success hidden" role="status">Bestellung gesendet. Danke! Bitte Posteingang/Spam prüfen.</div>

      <div class="footer-note">
        Hinweis: Mailversand erfolgt über EmailJS (clientseitig). Absender im Template = eure web.de-Adresse. Antworten gehen an die Kundenadresse (Reply-To).
      </div>
    </form>

    <footer>
      <small>* Sonderaktion: solange Vorrat reicht. Preise inkl. MwSt., ggf. zzgl. Versand. Lieferzeit: z. B. 2–4 Werktage.</small>
      <nav aria-label="Rechtliches">
        <a href="/impressum.html">Impressum</a> ·
        <a href="/datenschutz.html">Datenschutz</a>
      </nav>
    </footer>
  </main>

  <!-- EmailJS SDK -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    // =================== KONFIGURATION =========================
    const EMAILJS_PUBLIC_KEY = "xAOygDJhZcJrXGuSb";   // <- dein Public Key
    const EMAILJS_SERVICE_ID = "service_l642tri";     // <- deine Service ID
    const EMAILJS_TEMPLATE_ID = "template_ggtexbv";   // <- deine Template ID

    // Preise: Produkt 1 Staffel, Produkt 2 fix
    const PRICES = {
      p1: { single: 1.50, pack5: 4.95, pack10: 9.95 },
      p1PiecesPer: { single: 1, pack5: 5, pack10: 10 },
      p2: 5.00
    };
    // ===========================================================

    (function(){ emailjs.init(EMAILJS_PUBLIC_KEY); })();

    const el = (id) => document.getElementById(id);
    const formatEUR = (n) => n.toLocaleString('de-DE', { style: 'currency', currency: 'EUR' });

    function recalc() {
      const pack = el('p1Pack').value;
      const p1Qty = Math.max(0, parseInt(el('p1Qty').value || '0', 10));
      const p2Qty = Math.max(0, parseInt(el('p2Qty').value || '0', 10));

      const p1Pieces = PRICES.p1PiecesPer[pack] * p1Qty;
      el('p1PiecesHint').textContent = `Aktuell: ${p1Pieces} Stück`;

      const p1Subtotal = PRICES.p1[pack] * p1Qty;
      const p2Subtotal = PRICES.p2 * p2Qty;
      const total = p1Subtotal + p2Subtotal;

      el('p1Subtotal').value = formatEUR(p1Subtotal);
      el('p2Subtotal').value = formatEUR(p2Subtotal);
      el('grandTotal').textContent = formatEUR(total);

      if (p1Pieces > 0) {
        el('p1NamesBlock').classList.remove('hidden');
      } else {
        el('p1NamesBlock').classList.add('hidden');
        el('p1Names').value = '';
        el('p1NamesError').classList.add('hidden');
      }

      const lines = [];
      if (p1Qty > 0) {
        const packLabel = pack === 'single' ? 'Einzel' : (pack === 'pack5' ? '5er-Pack' : '10er-Pack');
        lines.push(`Produkt 1 (Glas-Tag) – ${packLabel} × ${p1Qty} = ${formatEUR(p1Subtotal)} (=${p1Pieces} Stück)`);
      }
      if (p2Qty > 0) lines.push(`Produkt 2 (Deluxe Kakao) × ${p2Qty} = ${formatEUR(p2Subtotal)}`);
      el('cartPreview').textContent = lines.length ? lines.join(' | ') : 'Noch keine Artikel.';
    }

    function validate() {
      if (el('hp_field').value) return { ok:false, msg:'Spam erkannt.' };

      const name = el('name').value.trim();
      const phone = el('phone').value.trim();
      const email = el('email').value.trim();
      const pack = el('p1Pack').value;
      const p1Qty = Math.max(0, parseInt(el('p1Qty').value || '0', 10));
      const p2Qty = Math.max(0, parseInt(el('p2Qty').value || '0', 10));
      const p1Pieces = PRICES.p1PiecesPer[pack] * p1Qty;

      if (!name || !phone || !email) return { ok:false, msg:'Bitte Name, Telefon und E-Mail ausfüllen.' };
      if (p1Qty + p2Qty === 0) return { ok:false, msg:'Bitte mindestens ein Produkt auswählen.' };

      if (p1Pieces > 0) {
        const names = el('p1Names').value.split('\n').map(s=>s.trim()).filter(Boolean);
        if (names.length !== p1Pieces) {
          el('p1NamesError').classList.remove('hidden');
          return { ok:false, msg:`Anzahl der Glas-Tag-Namen (${names.length}) passt nicht zur Stückzahl (${p1Pieces}).` };
        } else {
          el('p1NamesError').classList.add('hidden');
        }
      }
      return { ok:true };
    }

    ['p1Pack','p1Qty','p2Qty'].forEach(id => el(id).addEventListener('input', recalc));
    recalc();

    document.getElementById('orderForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      el('formError').classList.add('hidden');
      el('formOk').classList.add('hidden');

      const v = validate();
      if (!v.ok) {
        el('formError').textContent = v.msg;
        el('formError').classList.remove('hidden');
        return;
      }

      const pack = el('p1Pack').value;
      const p1Qty = Math.max(0, parseInt(el('p1Qty').value || '0', 10));
      const p2Qty = Math.max(0, parseInt(el('p2Qty').value || '0', 10));
      const p1Pieces = PRICES.p1PiecesPer[pack] * p1Qty;

      const p1SubtotalVal = PRICES.p1[pack] * p1Qty;
      const p2SubtotalVal = PRICES.p2 * p2Qty;

      const cartLines = [];
      if (p1Qty > 0) {
        const packLabel = pack === 'single' ? 'Einzel' : (pack === 'pack5' ? '5er-Pack' : '10er-Pack');
        cartLines.push(`Produkt 1 (Glas-Tag) – ${packLabel} × ${p1Qty} = ${formatEUR(p1SubtotalVal)} (=${p1Pieces} Stück)`);
      }
      if (p2Qty > 0) cartLines.push(`Produkt 2 (Deluxe Kakao) × ${p2Qty} = ${formatEUR(p2SubtotalVal)}`);

      const payload = {
        customer_name:  el('name').value.trim(),
        customer_phone: el('phone').value.trim(),
        customer_email: el('email').value.trim(),
        items_text:     cartLines.join(' | '),
        total:          el('grandTotal').textContent,
        p1_names:       el('p1Names').value,
        reply_to:       el('email').value.trim()
      };

      try {
        const result = await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, payload);
        if (result && result.status >= 200 && result.status < 300) {
          el('formOk').classList.remove('hidden');
          // e.target.reset(); recalc(); // optional
        } else {
          throw new Error('EmailJS: Unerwartete Antwort');
        }
      } catch (err) {
        console.error(err);
        el('formError').textContent = 'Senden fehlgeschlagen. Prüfe EmailJS Keys/IDs und Template.';
        el('formError').classList.remove('hidden');
      }
    });
  </script>
</body>
</html>
