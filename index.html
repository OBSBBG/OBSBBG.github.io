<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>OBS-Die-Firma – Sortiment</title>
  <meta name="description" content="OBS-Die-Firma: Glas-Tags & Deluxe Kakao. Jetzt bestellen und in der Schülerfirma abholen.">
  <meta name="theme-color" content="#003b1f">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --accent-green:#0c8a43; 
      --green:#34c759;
      --deep-green:#0b5d2a; 
      --price:#d40000;
      --ink:#161817;
      --border:#e6e9e7;
    }

    *{box-sizing:border-box;}
    body{
      margin:0;
      font-family:"Inter",sans-serif;
      padding:2rem;
      background:#fff;
      color:var(--ink);
    }
    main{width:min(1000px,100%);margin:auto;}

    /* ===== TICKER ===== */
    .ticker{width:100%;overflow:hidden;margin-bottom:1.5rem;}
    .ticker-bar{
      background:linear-gradient(90deg,#2fb457,#0c8a43);
      padding:.8rem 0;color:#fff;font-weight:800;
      border-radius:12px;
    }
    .ticker-track{
      white-space:nowrap;
      display:inline-block;
      animation:scroll 120s linear infinite;
    }
    .ticker-item{margin:0 1.6rem;}
    @keyframes scroll{
      0%{transform:translateX(100%)} 
      100%{transform:translateX(-100%)}
    }

    /* HERO */
    .hero{text-align:center;margin-bottom:1.5rem;}
    .brand{
      font-size:3.8rem;
      font-weight:900;
      background:linear-gradient(180deg,#0b5d2a,#0c8a43,#34c759,#c8ffd8);
      -webkit-background-clip:text;
      color:transparent;
    }
    .tagline{
      margin-top:.4rem;
      text-transform:uppercase;
      font-weight:800;
      color:#0b5d2a;
    }

    /* ÜBER UNS */
    .about{
      margin:1.2rem 0 2rem 0;
      padding:1rem;
      text-align:center;
      color:#0b5d2a;
      font-family:"Playfair Display",serif;
    }
    .about h2{
      margin-bottom:.35rem;
      font-size:1.8rem;
    }
    .about .ornament{
      width:140px;
      height:3px;
      background:linear-gradient(90deg,#d4af37,#f3e6b6,#d4af37);
      border-radius:3px;
      margin:0.3rem auto 1rem;
    }
    .about p{
      font-size:1.1rem;
      line-height:1.6;
    }

    /* PRODUKTE */
    .slot{
      border:1px solid var(--border);
      border-radius:16px;
      padding:1.2rem;
      margin-bottom:1rem;
      background:#fff;
    }
    .slot-body{
      display:flex;
      gap:12px;
    }
    .idx{
      width:64px;height:64px;
      background:#0c8a43;
      color:#fff;
      font-weight:900;
      border-radius:12px;
      display:flex;justify-content:center;align-items:center;
      font-size:1.3rem;
    }

    img{
      max-width:100%;
      display:block;
      border-radius:12px;
      margin-top:1rem;
    }

    /* Produkt 3 Bilder */
    .product3-images{
      position:relative;
      max-width:420px;
      margin:1.5rem auto 0;
    }
    .product3-main{width:100%;border-radius:12px;}
    .product3-overlay{
      position:absolute;
      width:60%;
      right:-20%;
      bottom:-10%;
      border-radius:12px;
      box-shadow:0 8px 22px rgba(0,0,0,.35);
    }
    .product3-tag5{
      position:absolute;
      width:55%;
      left:-20%;
      bottom:-10%;
      border-radius:12px;
      box-shadow:0 8px 22px rgba(0,0,0,.35);
    }
    .product3-tag6{
      position:absolute;
      width:55%;
      left:50%;
      transform:translateX(-50%);
      bottom:-28%;
      border-radius:12px;
      box-shadow:0 8px 22px rgba(0,0,0,.35);
    }

    /* Abstand nach unten, um Überschneidung zu verhindern */
    .game-section-offset{
      margin-top:280px;
    }

    /* SPIEL */
    .game-grid{
      display:grid;
      grid-template-columns:repeat(3,90px);
      gap:10px;
      justify-content:center;
      margin-top:1rem;
    }
    .tile{
      width:90px;height:90px;
      border-radius:10px;
      border:1px solid var(--border);
      background:#eee;
      cursor:pointer;
      overflow:hidden;
      position:relative;
    }
    .cover{
      position:absolute;
      inset:0;
      background:linear-gradient(180deg,#fdfdfd,#e5e5e5);
      transition:opacity .25s;
    }
    .pill{
      background:#f4f4f4;
      border:1px solid var(--border);
      padding:6px 10px;
      border-radius:999px;
      font-weight:700;
    }
    .win{color:#0b5d2a;font-weight:900;margin-top:.8rem;}
    .lose{color:#b00020;font-weight:900;margin-top:.8rem;}

    /* FORM */
    input,select,textarea{
      width:100%;
      padding:10px;
      border:1px solid var(--border);
      border-radius:10px;
      font-size:1rem;
    }
    button{
      padding:12px 16px;
      background:#0c8a43;
      color:#fff;
      border:0;
      border-radius:12px;
      font-weight:900;
      cursor:pointer;
    }
    .card{
      border:1px solid var(--border);
      padding:1rem;
      border-radius:14px;
      margin-top:1.2rem;
      background:#fff;
    }
    .grid{display:grid;gap:12px;}
    .row{
      display:grid;
      grid-template-columns:1fr 140px 160px;
      gap:10px;
      align-items:end;
    }
    .totals{
      display:flex;
      justify-content:space-between;
      margin-top:1rem;
      font-weight:900;
    }
    .error{color:#b00020;margin-top:.5rem;display:none;}
    .success{color:#0b5d2a;margin-top:.5rem;display:none;}

  </style>
</head>

<body>

  <!-- TICKER -->
  <div class="ticker">
    <div class="ticker-bar">
      <div id="tickerTrack" class="ticker-track">Lade Neuigkeiten …</div>
    </div>
  </div>

  <main>

    <!-- HERO -->
    <header class="hero">
      <h1 class="brand">OBS-Die-Firma</h1>
      <div class="tagline">Sortiment</div>
    </header>

    <!-- WER WIR SIND -->
    <section class="about">
      <h2>Wer wir sind</h2>
      <div class="ornament"></div>
      <p>Unsere Schülerfirma wird im Wahlpflichtkurs des 10. Jahrgangs entwickelt – ergänzt durch freiwillige Unterstützer.</p>
      <p>Alle Produkte entstehen in eigener Herstellung.</p>
      <p>Gewinne fließen vollständig zurück in das Projekt und erhöhen unser Eigenkapital.</p>
      <p>Ziel: echtes Unternehmertum lernen – mit Verantwortung.</p>
    </section>

    <!-- PRODUKT 1 -->
    <article class="slot">
      <div class="slot-body">
        <div class="idx">#1</div>
        <div>
          <h2>Personalisierter Glas-Tag</h2>
          <p><strong>Praktisches Gadget für Feiern.</strong></p>
          <ul>
            <li>Einzel: <span style="color:#d40000;font-weight:900;">1,50 €</span></li>
            <li>5er-Pack: <span style="color:#d40000;font-weight:900;">4,95 €</span></li>
            <li>10er-Pack: <span style="color:#d40000;font-weight:900;">9,95 €</span></li>
          </ul>
        </div>
      </div>
      <img src="Tag.jpeg">
    </article>

    <!-- PRODUKT 2 -->
    <article class="slot">
      <div class="slot-body">
        <div class="idx">#2</div>
        <div>
          <h2>Deluxe Kakao “Chocolate Bomb”</h2>
          <p><strong>Heiß aufgießen – cremiger Kakao.</strong></p>
          <p>Preis: <span style="color:#d40000;font-weight:900;">5,00 €</span></p>
        </div>
      </div>
      <img src="Tag2.jpeg">
    </article>

    <!-- PRODUKT 3 -->
    <article class="slot">
      <div class="slot-body">
        <div class="idx">#3</div>
        <div>
          <h2>Instant Kakao “Schneemann”</h2>
          <p><strong>Karamelliger Kakao mit Marshmallows.</strong></p>
          <p>Preis: <span style="color:#d40000;font-weight:900;">5,00 €</span></p>
        </div>
      </div>

      <div class="product3-images">
        <img class="product3-main" src="Schneemann2.jpeg">
        <img class="product3-overlay" src="Schneemann1.jpeg">
        <img class="product3-tag5" src="TAG5.jpeg">
        <img class="product3-tag6" src="TAG6.jpeg">
      </div>
    </article>

    <!-- SPIEL (tiefer gesetzt) -->
    <section class="card game-section-offset">
      <h2>Werbeaktion: Gewinne einen Glas-Tag</h2>
      <p>Decke in 5 Versuchen drei gleichfarbige Felder auf.</p>

      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:.5rem;">
        <button id="startGameBtn" type="button">Spiel starten</button>
        <button id="newGameBtn" type="button" style="display:none;">Neues Spiel</button>
        <span class="pill">Versuche: <span id="triesLeft">–</span></span>
        <span class="pill">Treffer: <span id="matchCount">0</span></span>
        <span class="pill" id="cooldownPill" style="display:none;">Warte <span id="cooldownSec">0</span>s</span>
      </div>

      <div id="gameGrid" class="game-grid"></div>
      <div id="gameMsg"></div>
    </section>

    <!-- FORM -->
    <form id="orderForm" class="shop" novalidate>
      <input id="hp_field" style="position:absolute;left:-9999px;" name="company">

      <div class="card">
        <h2>Kundendaten</h2>
        <div class="grid" style="grid-template-columns:1fr 1fr;">
          <div><label>Name*</label><input id="name" required></div>
          <div><label>Telefon*</label><input id="phone" required></div>
          <div style="grid-column:1/3;"><label>E-Mail*</label><input id="email" type="email" required></div>
          <div style="grid-column:1/3;"><label>Gewinncode (optional)</label><input id="coupon"></div>
        </div>
      </div>

      <div class="card">
        <h2>Produkte</h2>

        <!-- P1 -->
        <div class="row">
          <div>
            <label>Produkt 1</label>
            <select id="p1Pack">
              <option value="single">Einzel (1,50 €)</option>
              <option value="pack5">5er-Pack (4,95 €)</option>
              <option value="pack10">10er-Pack (9,95 €)</option>
            </select>
            <div id="p1PiecesHint" style="color:#777;">Aktuell: 0 Stück</div>
          </div>
          <div><label>Menge</label><input id="p1Qty" type="number" min="0" value="0"></div>
          <div><label>Summe</label><input id="p1Subtotal" readonly></div>
        </div>

        <div id="p1NamesBlock" class="grid" style="display:none;">
          <label>Namen (ein Name pro Zeile)</label>
          <textarea id="p1Names" rows="5"></textarea>
          <div id="p1NamesError" class="error">Anzahl stimmt nicht.</div>
        </div>

        <hr>

        <!-- P2 -->
        <div class="row">
          <div><label>Produkt 2</label><div style="color:#777;">Stück: 5,00 €</div></div>
          <div><label>Menge</label><input id="p2Qty" type="number" min="0" value="0"></div>
          <div><label>Summe</label><input id="p2Subtotal" readonly></div>
        </div>

        <!-- P3 -->
        <div class="row">
          <div><label>Produkt 3</label><div style="color:#777;">Stück: 5,00 €</div></div>
          <div><label>Menge</label><input id="p3Qty" type="number" min="0" value="0"></div>
          <div><label>Summe</label><input id="p3Subtotal" readonly></div>
        </div>

        <div class="totals">
          <span>Gesamt:</span>
          <span id="grandTotal">0,00 €</span>
        </div>
      </div>

      <div class="card">
        <h2>Warenkorb</h2>
        <div id="cartPreview" style="color:#777">Noch keine Artikel.</div>
      </div>

      <div style="display:flex;justify-content:space-between;margin-top:1rem;">
        <div style="color:#777;">Abholung in der Schule – keine Lieferung.</div>
        <button type="submit">Absenden</button>
      </div>

      <div id="formError" class="error"></div>
      <div id="formOk" class="success"></div>
    </form>

    <footer style="margin-top:2rem;text-align:center;font-size:0.9rem;">
      <a href="/impressum.html">Impressum</a> · <a href="/datenschutz.html">Datenschutz</a>
    </footer>

  </main>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <script>
    const EMAILJS_PUBLIC_KEY   = "xAOygDJhZcJrXGuSb";
    const EMAILJS_SERVICE_ID   = "service_l642tri";
    const EMAILJS_TEMPLATE_ID  = "template_ggtexbv";
    emailjs.init(EMAILJS_PUBLIC_KEY);
  </script>

  <!-- Ticker -->
  <script>
    document.getElementById("tickerTrack").innerHTML = `
      <span class="ticker-item">Glas-Tags – eigene Produktentwicklung der OBS.</span>
      <span class="ticker-item">Deluxe Kakao „Chocolate Bomb“ – nur für kurze Zeit.</span>
      <span class="ticker-item">Instant Kakao „Schneemann“ – limitierte Aktion.</span>
      <span class="ticker-item">Alle Erlöse stärken das Projekt – Danke!</span>
    `;
  </script>

  <!-- SPIEL -->
  <script>
    (function(){

      const startBtn = document.getElementById("startGameBtn");
      const newBtn   = document.getElementById("newGameBtn");
      const grid     = document.getElementById("gameGrid");
      const msg      = document.getElementById("gameMsg");
      const triesEl  = document.getElementById("triesLeft");
      const matchEl  = document.getElementById("matchCount");
      const cooldown = document.getElementById("cooldownPill");
      const coolSec  = document.getElementById("cooldownSec");
      const couponField = document.getElementById("coupon");

      const COLORS = ["#0c8a43","#ffb300","#1565c0"];

      let tiles=[];
      let tries=5;
      let matches=0;
      let running=false;
      let failCounter=0;
      let lockTimer=null;
      let clickLocked=false;

      function makeTiles(){
        grid.innerHTML="";
        tiles=[];

        const pool=[];
        COLORS.forEach(c=>{for(let i=0;i<3;i++) pool.push(c);});
        pool.sort(()=>Math.random()-0.5);

        pool.forEach(color=>{
          const t=document.createElement("div");
          t.className="tile";
          t.dataset.color=color;

          const cover=document.createElement("div");
          cover.className="cover";
          t.appendChild(cover);

          t.onclick = ()=>{ if(!clickLocked && running) reveal(t); };
          tiles.push(t);
          grid.appendChild(t);
        });
      }

      function reset(){

        tries=5;
        matches=0;
        failCounter=0;
        clickLocked=false;

        triesEl.textContent=tries;
        matchEl.textContent=matches;

        msg.textContent="";
        msg.className="";

        cooldown.style.display="none";

        if(lockTimer){clearInterval(lockTimer); lockTimer=null;}

        makeTiles();

        running=true;
      }

      function generateCode(){
        return "GT-" + (10000 + Math.floor(Math.random()*90000));
      }

      function reveal(tile){
        const cover=tile.querySelector(".cover");
        if(!cover || cover.style.opacity==="0") return;

        cover.style.opacity="0";
        tile.style.background=tile.dataset.color;

        const color=tile.dataset.color;
        const opened = tiles.filter(t=>{
          const c=t.querySelector(".cover");
          return c.style.opacity==="0" && t.dataset.color===color;
        });

        if(opened.length === 3){
          running=false;
          const code=generateCode();
          couponField.value=code;
          msg.innerHTML=`GEWONNEN! Dein Code: <strong>${code}</strong>`;
          msg.className="win";
          return;
        }

        tries--;
        triesEl.textContent=tries;

        if(tries<=0){
          running=false;
          msg.textContent="Leider kein Treffer.";
          msg.className="lose";
          return;
        }

        failCounter++;

        if(failCounter % 5 === 0){
          let sec = 2 * (failCounter/5);
          clickLocked=true;
          cooldown.style.display="inline-block";
          coolSec.textContent=sec;

          if(lockTimer){clearInterval(lockTimer);}
          lockTimer=setInterval(()=>{
            sec--;
            coolSec.textContent=sec;
            if(sec<=0){
              clearInterval(lockTimer);
              lockTimer=null;
              cooldown.style.display="none";
              clickLocked=false;
            }
          },1000);
        }
      }

      startBtn.onclick = ()=>{
        startBtn.style.display="none";
        newBtn.style.display="inline-block";
        reset();
      };

      newBtn.onclick = reset;

    })();
  </script>

  <!-- SHOP -->
  <script>
    (function(){

      const p1Pack=document.getElementById("p1Pack");
      const p1Qty=document.getElementById("p1Qty");
      const p1Subtotal=document.getElementById("p1Subtotal");
      const p1PiecesHint=document.getElementById("p1PiecesHint");
      const p1NamesBlock=document.getElementById("p1NamesBlock");
      const p1Names=document.getElementById("p1Names");
      const p1Err=document.getElementById("p1NamesError");

      const p2Qty=document.getElementById("p2Qty");
      const p2Subtotal=document.getElementById("p2Subtotal");

      const p3Qty=document.getElementById("p3Qty");
      const p3Subtotal=document.getElementById("p3Subtotal");

      const cart=document.getElementById("cartPreview");
      const total=document.getElementById("grandTotal");

      function clamp(x){x=parseInt(x); return isNaN(x)?0:Math.min(999,Math.max(0,x));}
      function money(n){return n.toLocaleString("de-DE",{style:"currency",currency:"EUR"});}

      const PACK_PRICES={single:1.50,pack5:4.95,pack10:9.95};
      const PACK_PIECES={single:1,pack5:5,pack10:10};
      const P2=5.00;
      const P3=5.00;

      function refresh(){

        const pack=p1Pack.value;
        const q1=clamp(p1Qty.value);
        const pcs=q1*PACK_PIECES[pack];
        const t1=q1*PACK_PRICES[pack];

        p1PiecesHint.textContent="Aktuell: "+pcs+" Stück";
        p1Subtotal.value = q1>0 ? money(t1) : "";

        if(q1>0){p1NamesBlock.style.display="grid";}
        else{p1NamesBlock.style.display="none"; p1Err.style.display="none";}

        const q2=clamp(p2Qty.value);
        const t2=q2*P2;
        p2Subtotal.value = q2>0 ? money(t2) : "";

        const q3=clamp(p3Qty.value);
        const t3=q3*P3;
        p3Subtotal.value = q3>0 ? money(t3) : "";

        const sum=t1+t2+t3;
        total.textContent=money(sum);

        const lines=[];
        if(pcs>0) lines.push("Glas-Tag: "+pcs+" Stück – "+money(t1));
        if(q2>0) lines.push("Chocolate Bomb: "+q2+"× – "+money(t2));
        if(q3>0) lines.push("Schneemann: "+q3+"× – "+money(t3));

        cart.innerHTML = lines.length ? lines.join("<br>") : "Noch keine Artikel.";

        return {pcs,q1,t1,q2,t2,q3,t3,sum};
      }

      p1Pack.onchange=refresh;
      p1Qty.oninput=refresh;
      p2Qty.oninput=refresh;
      p3Qty.oninput=refresh;

      refresh();

    })();
  </script>

  <!-- FORM -->
  <script>
    (function(){

      const form=document.getElementById("orderForm");
      const err=document.getElementById("formError");
      const ok=document.getElementById("formOk");

      const p1Qty=document.getElementById("p1Qty");
      const p1Pack=document.getElementById("p1Pack");
      const p1PiecesHint=document.getElementById("p1PiecesHint");
      const p1Names=document.getElementById("p1Names");
      const p1NamesBlock=document.getElementById("p1NamesBlock");
      const p1Err=document.getElementById("p1NamesError");

      const p2Qty=document.getElementById("p2Qty");
      const p3Qty=document.getElementById("p3Qty");

      const PACK_PIECES={single:1,pack5:5,pack10:10};
      const PACK_PRICES={single:1.50,pack5:4.95,pack10:9.95};
      const P2=5.00;
      const P3=5.00;

      const total=document.getElementById("grandTotal");
      const cart=document.getElementById("cartPreview");

      const hp=document.getElementById("hp_field");

      function clamp(n){n=parseInt(n);return isNaN(n)?0:Math.max(0,Math.min(999,n));}
      function money(n){return n.toLocaleString("de-DE",{style:"currency",currency:"EUR"});}

      function recalc(){
        const pack=p1Pack.value;
        const q1=clamp(p1Qty.value);
        const pcs=q1*PACK_PIECES[pack];
        const t1=q1*PACK_PRICES[pack];

        const q2=clamp(p2Qty.value);
        const t2=q2*P2;

        const q3=clamp(p3Qty.value);
        const t3=q3*P3;

        const sum=t1+t2+t3;
        total.textContent=money(sum);

        const lines=[];
        if(pcs>0) lines.push("Glas-Tag: "+pcs+" Stück – "+money(t1));
        if(q2>0) lines.push("Chocolate Bomb: "+q2+"× – "+money(t2));
        if(q3>0) lines.push("Schneemann: "+q3+"× – "+money(t3));

        cart.innerHTML = lines.length?lines.join("<br>"):"Noch keine Artikel.";

        if(pcs>0) p1NamesBlock.style.display="grid";
        else {p1NamesBlock.style.display="none"; p1Err.style.display="none";}

        return {pcs,t1,q2,t2,q3,t3,sum};
      }

      p1Pack.onchange=recalc;
      p1Qty.oninput=recalc;
      p2Qty.oninput=recalc;
      p3Qty.oninput=recalc;

      recalc();

      function countLines(txt){
        return String(txt).split(/\n/).map(l=>l.trim()).filter(Boolean).length;
      }

      form.onsubmit=function(e){
        e.preventDefault();

        err.style.display="none";
        ok.style.display="none";

        if(hp.value.trim()!=="") return;

        const name=document.getElementById("name").value.trim();
        const phone=document.getElementById("phone").value.trim();
        const email=document.getElementById("email").value.trim();
        const coupon=document.getElementById("coupon").value.trim();

        if(!name || !phone || !email){
          err.textContent="Bitte Name, Telefon und E-Mail ausfüllen.";
          err.style.display="block";
          return;
        }

        const state=recalc();

        if(state.pcs===0 && state.q2===0 && state.q3===0){
          err.textContent="Bitte mindestens ein Produkt wählen.";
          err.style.display="block";
          return;
        }

        if(state.pcs>0){
          const given=countLines(p1Names.value);
          if(given !== state.pcs){
            p1Err.style.display="block";
            err.textContent="Die Anzahl der Namen passt nicht.";
            err.style.display="block";
            return;
          }
        }

        const lines=[];
        if(state.pcs>0) lines.push("Glas-Tag: "+state.pcs+" Stück – "+money(state.t1));
        if(state.q2>0)  lines.push("Chocolate Bomb: "+state.q2+"× – "+money(state.t2));
        if(state.q3>0)  lines.push("Schneemann: "+state.q3+"× – "+money(state.t3));

        const payload={
          name,
          phone,
          email,
          coupon,
          products:lines.join("<br>"),
          total:money(state.sum),
          names_list:p1Names.value
        };

        emailjs.send(EMAILJS_SERVICE_ID,EMAILJS_TEMPLATE_ID,payload)
        .then(()=>{
          ok.textContent="Gesendet – wir melden uns!";
          ok.style.display="block";
          form.reset();
          p1NamesBlock.style.display="none";
          recalc();
        })
        .catch(()=>{
          err.textContent="Fehler beim Senden.";
          err.style.display="block";
        });

      };

    })();
  </script>

</body>
</html>
